"use strict";var h=Object.defineProperty;var k=Object.getOwnPropertyDescriptor;var O=Object.getOwnPropertyNames;var R=Object.prototype.hasOwnProperty;var D=(r,e)=>{for(var t in e)h(r,t,{get:e[t],enumerable:!0})},T=(r,e,t,a)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of O(e))!R.call(r,n)&&n!==t&&h(r,n,{get:()=>e[n],enumerable:!(a=k(e,n))||a.enumerable});return r};var S=r=>T(h({},"__esModule",{value:!0}),r);var u=(r,e,t)=>new Promise((a,n)=>{var f=c=>{try{d(t.next(c))}catch(m){n(m)}},o=c=>{try{d(t.throw(c))}catch(m){n(m)}},d=c=>c.done?a(c.value):Promise.resolve(c.value).then(f,o);d((t=t.apply(r,e)).next())});var W={};D(W,{convertToSheet:()=>C,convertToSheets:()=>F});module.exports=S(W);var l=require("exceljs");function i(r,e={},t=""){for(let a in r)typeof r[a]=="string"?e[t+a]=r[a]:(t+=`${a}.`,i(r[a],e,t));return e}function g(r){return r.map(e=>i(e))}function j(r){return typeof r=="boolean"?r?"1":"0":typeof r=="number"?""+r:r}function s(r){return r.map(e=>{let t={};for(let a in e)t[a]=j(e[a]);return t})}var y=require("path");function C(r,e){return u(this,null,function*(){var f,o,d;let t=g(s(r)),a=new l.Workbook;x(a,{data:t,config:{options:e},name:(f=e==null?void 0:e.filename)!=null?f:"Feuille"});let n=(o=e==null?void 0:e.format)!=null?o:"xlsx";return e!=null&&e.path?yield a[n].writeFile((0,y.join)(e.path,`${(d=e==null?void 0:e.filename)!=null?d:"result"}.${n}`)):yield a[n].writeBuffer()})}function F(r,e){return u(this,null,function*(){var n,f;let t=new l.Workbook;for(let o of r)x(t,o);let a=(n=e==null?void 0:e.format)!=null?n:"xlsx";return e!=null&&e.path?yield t[a].writeFile((0,y.join)(e.path,`${(f=e==null?void 0:e.filename)!=null?f:"result"}.${a}`)):yield t[a].writeBuffer()})}function x(r,e){let t=r.addWorksheet(e.name),a=e.data.length===0?[]:e.data[0];t.columns=Object.keys(a).map(f=>{var o,d,c,m,b,w;return{header:(d=(o=e.config)==null?void 0:o.options)!=null&&d.headers&&f in((m=(c=e.config)==null?void 0:c.options)==null?void 0:m.headers)?(w=(b=e.config)==null?void 0:b.options)==null?void 0:w.headers[f]:f,key:f,width:20}});let n=g(s(e.data));t.addRows(n)}0&&(module.exports={convertToSheet,convertToSheets});
